FROM rust:1-alpine3.20

RUN apk add --no-cache \
      build-base \
      bash \
      git \
      zstd \
      musl-dev && \
    # Provide musl-gcc wrapper expected by .cargo/config.toml
    ln -sf /usr/bin/gcc /usr/bin/musl-gcc

WORKDIR /workspace

CMD ["bash", "-lc", "cd /workspace && ./scripts/build-alpine-apk.sh"]

